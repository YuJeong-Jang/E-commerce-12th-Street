/*
 * 1stpjt 루트 프로젝트용 build.gradle (Groovy DSL)
 * - 내장 톰캣(Tomcat)
 * - JSP/Servlet
 * - MySQL / Bcrypt
 */

// 플러그인 설정
plugins {
    id 'java'
    id 'application'
}

// 자바 버전 17 설정
java {

    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
}

application {
    mainClass.set('com.commerce.member.Main')
}

// 라이브러리를 다운로드할 저장소 (Maven 중앙 저장소)
repositories {
    mavenCentral()
}

// 프로젝트 의존성 (가장 중요)
dependencies {

    implementation 'org.mariadb.jdbc:mariadb-java-client:3.4.1'

    implementation 'org.apache.tomcat.embed:tomcat-embed-core:10.1.20'
    implementation 'org.apache.tomcat.embed:tomcat-embed-jasper:10.1.20'
    implementation 'org.apache.tomcat.embed:tomcat-embed-el:10.1.20'

    compileOnly 'jakarta.servlet:jakarta.servlet-api:6.0.0'
    compileOnly 'jakarta.servlet.jsp:jakarta.servlet.jsp-api:3.1.0'

    implementation 'jakarta.servlet.jsp.jstl:jakarta.servlet.jsp.jstl-api:3.0.0'
    implementation 'org.glassfish.web:jakarta.servlet.jsp.jstl:3.0.1'

    // // === 내장 톰캣 (Tier 1/2) ===
    // // 1. 내장 톰캣 코어 (서버 본체)
    // implementation 'org.apache.tomcat.embed:tomcat-embed-core:9.0.83'
    
    // // 2. 내장 톰캣 JSP 실행 엔진 (JSP 파일을 서블릿으로 변환)
    // implementation 'org.apache.tomcat.embed:tomcat-embed-jasper:9.0.83'
    
    // // 3. JSTL (JSP에서 <c:forEach>, <c:if> 같은 태그 사용)
    // //    javax.servlet.* API를 포함하고 있음 (이전 에러의 원인)
    // implementation 'org.glassfish.web:jakarta.servlet.jsp.jstl:2.0.0'

    // // === 데이터베이스 (Tier 3) ===
    // // 4. MySQL 커넥터 (DB와 통신하는 드라이버)
    // implementation 'com.mysql:mysql-connector-j:8.0.33'
    
    // 5. Bcrypt (비밀번호 암호화)
    implementation 'org.mindrot:jbcrypt:0.4'

}

// Gradle이 src/main/webapp 폴더(JSP 위치)를 빌드에 포함하도록 설정
sourceSets {
    main {
        resources {
            srcDirs('src/main/webapp')
        }
    }
}


// 인코딩 설정
tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}
